var
  i,k:Integer;
begin
  //inherited;
  mmo1.Clear;
  for i :=  0  to dmCardImp.ComponentCount-1 do
  begin
    if dmCardImp.Components[i] is TKCWVQuery then
    begin
      mmo1.Lines.Add('-------------------------------------------------------');
      mmo1.Lines.Add('功能名称  '+TKCWVQuery(dmCardImp.Components[i]).ID);
      mmo1.Lines.Add('功能号  '+inttostr(TKCWVQuery(dmCardImp.Components[i]).requesttype));
      mmo1.Lines.Add('需求说明');
      mmo1.Lines.Add('限制条件');
      mmo1.Lines.Add('业务逻辑');

      mmo1.Lines.Add('输入  参数  CPACK字段   类型  备注');
      //输入项
      for k := 0 to TKCWVQuery(dmCardImp.Components[i]).InputBindings.Count-1 do
        mmo1.Lines.Add('输入  '+TKCParamBinding(TKCWVQuery(dmCardImp.Components[i]).InputBindings.Items[k]).ParamName+'    '+TKCParamBinding(TKCWVQuery(dmCardImp.Components[i]).InputBindings.Items[k]).FieldName);

      //输出项
      mmo1.Lines.Add('输入  参数  CPACK字段   类型  备注');
      for k := 0 to TKCWVQuery(dmCardImp.Components[i]).OutputBindings.Count-1 do
        mmo1.Lines.Add('输出  '+TKCParamBinding(TKCWVQuery(dmCardImp.Components[i]).OutputBindings.Items[k]).ParamName+'    '+TKCParamBinding(TKCWVQuery(dmCardImp.Components[i]).OutputBindings.Items[k]).FieldName);

    end;

    if dmCardImp.Components[i] is TKCWVProcessor then
    begin
      //if inttostr(TKCWVProcessor(dmCardImp.Components[i]).RequestType)='847120' then
        //Continue;
      mmo1.Lines.Add('-------------------------------------------------------');
      mmo1.Lines.Add('功能名称  '+TKCWVProcessor(dmCardImp.Components[i]).ID);
      mmo1.Lines.Add('功能号  '+inttostr(TKCWVProcessor(dmCardImp.Components[i]).RequestType));

      mmo1.Lines.Add('需求说明');
      mmo1.Lines.Add('限制条件');
      mmo1.Lines.Add('业务逻辑');

      mmo1.Lines.Add('输入  参数  CPACK字段   类型  备注');
      for k := 0 to TKCWVProcessor(dmCardImp.Components[i]).InputBindings.Count-1 do
        mmo1.Lines.Add('输入  '+TKCParamBinding(TKCWVProcessor(dmCardImp.Components[i]).InputBindings.Items[k]).ParamName+'    '+TKCParamBinding(TKCWVProcessor(dmCardImp.Components[i]).InputBindings.Items[k]).FieldName);

      //输出项
      mmo1.Lines.Add('输入  参数  CPACK字段   类型  备注');
      for k := 0 to TKCWVProcessor(dmCardImp.Components[i]).OutputBindings.Count-1 do
        mmo1.Lines.Add('输出  '+TKCParamBinding(TKCWVProcessor(dmCardImp.Components[i]).OutputBindings.Items[k]).ParamName+'    '+TKCParamBinding(TKCWVProcessor(dmCardImp.Components[i]).OutputBindings.Items[k]).FieldName);

    end;
    
  end;
  mmo1.Lines.SaveToFile('c:\sss.text');
