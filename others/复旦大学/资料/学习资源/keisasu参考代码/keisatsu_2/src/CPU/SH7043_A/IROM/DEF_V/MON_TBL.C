/*--------------------------------------------------------------------------*/
/*  プロジェクト : POPLAR/ANZU_L                                            */
/*  ファイル名   : MON_TBL.C                                                */
/*  作成者       : 野瀬                                                     */
/*  日  付       : 97.04.09                                                 */
/*  概  要       : モニタ管理ブロック（ＴＣＢ、ＭＣＢ等）の                 */
/*               : 先頭アドレステーブル                                     */
/*               : モニターコールから管理ブロックへのアクセスは以下の       */
/*               : ポインタを間接参照することにより行います                 */
/*  修正履歴     :                                                          */
/*--------------------------------------------------------------------------*/

#include "\src\atlanta\define\product.h"

#include "\src\atlanta\sh7043\define\mon_func.h"
#include "\src\atlanta\sh7043\define\def_mon.h"
#include "\src\atlanta\sh7043\define\def_tib.h"
#include "\src\atlanta\sh7043\ext_v\extv_mon.h"
#include "\src\atlanta\sh7043\ext_v\extv_mbx.h"
#include "\src\atlanta\sh7043\ext_v\extv_sem.h"

#if (PRO_CPU_VERSION == SH7043_R)
#pragma section MONTBL /* locate section name "CMONTBL" { */
/**************************************************
 * 外付けＲＯＭ（Ｆｌａｓｈ等）エリアの先頭を示す *
 **************************************************/
CONST UBYTE INI_ROMAreaIndicater[] = "Ext.ROM";

/************************************************
 * 管理ブロックの先頭アドレスを持つポインター群 *
 ***********************************************/
/************************************************************************
 * タスクイニシャルブロックの先頭アドレス								*
 * 野瀬敏弘																*
 ************************************************************************/
CONST struct tib_table_data_t (* CONST tib_pc) = &tib[0];

/************************************************************************
 * タスクコントロールブロックの先頭アドレス								*
 * 野瀬敏弘																*
 ************************************************************************/
CONST struct tcb_table_data_t (* CONST tcb_pc) = &tcb[0];

/************************************************************************
 * セマフォコントロールブロックの先頭アドレス							*
 * 野瀬敏弘																*
 ************************************************************************/
CONST struct scb_table_data_t (* CONST scb_pc) = &scb[0];

/************************************************************************
 * メッセージコントロールブロックの先頭アドレス							*
 * 野瀬敏弘																*
 ************************************************************************/
CONST UBYTE (* CONST mcb_pc) = &mcb[0];

/************************************************************************
 * イベントコントロールブロックの先頭アドレス							*
 * 野瀬敏弘																*
 ************************************************************************/
CONST UBYTE (* CONST ecb_pc) = &ecb[0];

/************************************************************************
 * スタックアドレスチェックテーブルの先頭アドレス						*
 * 野瀬敏弘																*
 ************************************************************************/
CONST UDWORD (* CONST MON_StackCheckTable_pc) = &MON_StackCheckTable[0];

/************************************************************************
 * 大サイズのスタック領域の先頭アドレス									*
 * 野瀬敏弘																*
 ************************************************************************/
CONST UDWORD (* CONST large_stack_area_pc) = &large_stack_area[0][0];

/************************************************************************
 * 小サイズのスタック領域の先頭アドレス									*
 * 野瀬敏弘																*
 ************************************************************************/
CONST UDWORD (* CONST small_stack_area_pc) = &small_stack_area[0][0];

/************************************************************************
 * アイドルタスクのスタック領域の先頭アドレス							*
 * 野瀬敏弘																*
 ************************************************************************/
CONST UDWORD (* CONST initial_task_stack_area_pc) = &small_stack_area[SMALL_STACK_MAX - 1][0];

/************************************************************************
 * メールボックス管理テーブルの先頭アドレス								*
 * 野瀬敏弘																*
 ************************************************************************/
CONST struct mbxno_data_t (* CONST mbxno_pc) = &mbxno;

/************************************************************************
 * セマフォ管理テーブルの先頭アドレス									*
 * 野瀬敏弘																*
 ************************************************************************/
CONST struct semno_data_t (* CONST semno_pc) = &semno;


/************************************
 * 管理ブロックの最大値を持つ定数群 *
 ***********************************/
/************************************************************************
 * 大タスクコントロールブロックの最大値									*
 * 野瀬敏弘																*
 ************************************************************************/
CONST UBYTE MON_MAX_LARGE_TCB_C = LARGE_STACK_MAX;

/************************************************************************
 * 小タスクコントロールブロックの最大値									*
 * 野瀬敏弘																*
 ************************************************************************/
CONST UBYTE MON_MAX_SMALL_TCB_C = SMALL_STACK_MAX;

/************************************************************************
 * 大・小合計のタスクコントロールブロックの最大値						*
 * 野瀬敏弘																*
 ************************************************************************/
CONST UBYTE MON_MAX_TCB_C = TOTAL_STACK_MAX;

/************************************************************************
 * 大タスクのスタックサイズ												*
 * 野瀬敏弘																*
 ************************************************************************/
CONST UWORD MON_SIZE_LARGE_STACK_C = LARGE_STACK;

/************************************************************************
 * 小タスクのスタックサイズ												*
 * 野瀬敏弘																*
 ************************************************************************/
CONST UWORD MON_SIZE_SMALL_STACK_C = SMALL_STACK;

/************************************************************************
 * スタックエリアの底アドレス											*
 * 野瀬敏弘																*
 ************************************************************************/
CONST UDWORD MON_STACK_START_ADDR_C = TASK_STACK_START;

/************************************************************************
 * 大タスククリエイト時のスタック開始基準アドレス						*
 * 野瀬敏弘																*
 ************************************************************************/
CONST UDWORD MON_TOP_LARGE_ADDR_C = TOP_LARGE_ADDR;

/************************************************************************
 * 小タスククリエイト時のスタック開始基準アドレス						*
 * 野瀬敏弘																*
 ************************************************************************/
CONST UDWORD MON_TOP_SMALL_ADDR_C = TOP_SMALL_ADDR;

/************************************************************************
 * ＳＣＢの最大値														*
 * 野瀬敏弘																*
 ************************************************************************/
CONST UBYTE MON_MAX_SCB_C = SEMNO_MAX;

/************************************************************************
 * セマフォ管理テーブルの最大値											*
 * 野瀬敏弘																*
 ************************************************************************/
CONST UBYTE MON_MAX_SEMNO_C = MAX_SEMNO;

/************************************************************************
 * ＭＣＢの最大値														*
 * 野瀬敏弘																*
 ************************************************************************/
CONST UWORD MON_MAX_MCB_C = MBXNO_MAX;

/************************************************************************
 * メールボックス管理テーブルの最大値									*
 * 野瀬敏弘																*
 ************************************************************************/
CONST UBYTE MON_MAX_MBXNO_C = MAX_MBXNO;

/************************************************************************
 * ＥＣＢの最大値														*
 * 野瀬敏弘																*
 ************************************************************************/
CONST UWORD MON_MAX_ECB_C = EVENT_MAX;

/*******************************************/
/* SCDからコールされるモニタの先頭アドレス */
/*******************************************/
CONST void (* CONST wai_tsk_vecc)() = (void (*)())wai_tsk_irom;
CONST void (* CONST wai_oneshot_vecc)() = (void (*)())wai_oneshot_irom;
CONST void (* CONST rcv_msg_vecc)() = (void (*)())rcv_msg_irom;

/**************************************/
/* モニターサブルーチンの先頭アドレス */
/**************************************/
CONST void (* CONST cre_ready_link_vecc)() = (void (*)())cre_ready_link_irom;
CONST void (* CONST del_ready_link_vecc)() = (void (*)())del_ready_link_irom;
CONST void (* CONST rescheduler_vecc)() = (void (*)())rescheduler_irom;
CONST void (* CONST ready_func_vecc)() = (void (*)())ready_func_irom;
CONST void (* CONST monitor_error_vecc)() = (void (*)())monitor_error;
CONST void (* CONST SetOneshotTimer_vecc)() = (void (*)())SetOneshotTimer_irom;


/****************************************/
/* システム初期化ルーチンの先頭アドレス */
/****************************************/
CONST void (* CONST InitializeSystem_vecc)() = (void (*)())InitializeSystem;

#pragma section /* } */

#pragma section MONTBLIMG /* locate section name "BMONTBLIMG" */
/************************************/
/* 内蔵ＲＡＭに配置する定数群の写像 */
/************************************/
/************************************************************************
 * タスクイニシャルブロックの先頭アドレス								*
 * 野瀬敏弘																*
 ************************************************************************/
struct tib_table_data_t *tib_p;

/************************************************************************
 * タスクコントロールブロックの先頭アドレス								*
 * 野瀬敏弘																*
 ************************************************************************/
struct tcb_table_data_t *tcb_p;

/************************************************************************
 * セマフォコントロールブロックの先頭アドレス							*
 * 野瀬敏弘																*
 ************************************************************************/
struct scb_table_data_t *scb_p;

/************************************************************************
 * メッセージコントロールブロックの先頭アドレス							*
 * 野瀬敏弘																*
 ************************************************************************/
UBYTE *mcb_p;

/************************************************************************
 * イベントコントロールブロックの先頭アドレス							*
 * 野瀬敏弘																*
 ************************************************************************/
UBYTE *ecb_p;

/************************************************************************
 * スタックアドレスチェックテーブルの先頭アドレス						*
 * 野瀬敏弘																*
 ************************************************************************/
UDWORD *MON_StackCheckTable_p;

/************************************************************************
 * 大サイズのスタック領域の先頭アドレス									*
 * 野瀬敏弘																*
 ************************************************************************/
UDWORD *large_stack_area_p;

/************************************************************************
 * 小サイズのスタック領域の先頭アドレス									*
 * 野瀬敏弘																*
 ************************************************************************/
UDWORD *small_stack_area_p;

/************************************************************************
 * アイドルタスクのスタック領域の先頭アドレス							*
 * 野瀬敏弘																*
 ************************************************************************/
UDWORD *initial_task_stack_area_p;

/************************************************************************
 * メールボックス管理テーブルの先頭アドレス								*
 * 野瀬敏弘																*
 ************************************************************************/
struct mbxno_data_t *mbxno_p;

/************************************************************************
 * セマフォ管理テーブルの先頭アドレス									*
 * 野瀬敏弘																*
 ************************************************************************/
struct semno_data_t *semno_p;


/************************************
 * 管理ブロックの最大値を持つ定数群 *
 ***********************************/
/************************************************************************
 * 大タスクコントロールブロックの最大値									*
 * 野瀬敏弘																*
 ************************************************************************/
UBYTE MON_MAX_LARGE_TCB;

/************************************************************************
 * 小タスクコントロールブロックの最大値									*
 * 野瀬敏弘																*
 ************************************************************************/
UBYTE MON_MAX_SMALL_TCB;

/************************************************************************
 * 大・小合計のタスクコントロールブロックの最大値						*
 * 野瀬敏弘																*
 ************************************************************************/
UBYTE MON_MAX_TCB;

/************************************************************************
 * 大タスクのスタックサイズ												*
 * 野瀬敏弘																*
 ************************************************************************/
UWORD MON_SIZE_LARGE_STACK;

/************************************************************************
 * 小タスクのスタックサイズ												*
 * 野瀬敏弘																*
 ************************************************************************/
UWORD MON_SIZE_SMALL_STACK;

/************************************************************************
 * スタックエリアの底アドレス											*
 * 野瀬敏弘																*
 ************************************************************************/
UDWORD MON_STACK_START_ADDR;

/************************************************************************
 * 大タスククリエイト時のスタック開始基準アドレス						*
 * 野瀬敏弘																*
 ************************************************************************/
UDWORD MON_TOP_LARGE_ADDR;

/************************************************************************
 * 小タスククリエイト時のスタック開始基準アドレス						*
 * 野瀬敏弘																*
 ************************************************************************/
UDWORD MON_TOP_SMALL_ADDR;

/************************************************************************
 * ＳＣＢの最大値														*
 * 野瀬敏弘																*
 ************************************************************************/
UBYTE MON_MAX_SCB;

/************************************************************************
 * セマフォ管理テーブルの最大値											*
 * 野瀬敏弘																*
 ************************************************************************/
UBYTE MON_MAX_SEMNO;

/************************************************************************
 * ＭＣＢの最大値														*
 * 野瀬敏弘																*
 ************************************************************************/
UWORD MON_MAX_MCB;

/************************************************************************
 * メールボックス管理テーブルの最大値									*
 * 野瀬敏弘																*
 ************************************************************************/
UBYTE MON_MAX_MBXNO;

/************************************************************************
 * ＥＣＢの最大値														*
 * 野瀬敏弘																*
 ************************************************************************/
UWORD MON_MAX_ECB;

/*******************************************/
/* SCDからコールされるモニタの先頭アドレス */
/*******************************************/
void *wai_tsk_vec;
void *wai_oneshot_vec;
void *rcv_msg_vec;

/**************************************/
/* モニターサブルーチンの先頭アドレス */
/**************************************/
void *cre_ready_link_vec;
void *del_ready_link_vec;
void *rescheduler_vec;
void *ready_func_vec;
void *monitor_error_vec;
void *SetOneshotTimer_vec;

/****************************************/
/* システム初期化ルーチンの先頭アドレス */
/****************************************/
void *InitializeSystem_vec;

#pragma section

#endif
