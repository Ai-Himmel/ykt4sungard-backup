;/*--------------------------------------------------------------------------*/
;/*  プロジェクト : RISC                                                     */
;/*  ファイル名   : def_mon.ih                                               */
;/*  作成者       : 野瀬                                                     */
;/*  日  付       : 95.11.01                                                 */
;/*  概  要       : モニタdefine定義                                         */
;/*  修正履歴     :                                                          */
;/*--------------------------------------------------------------------------*/
;-----------------------------------------------------------------------------
; ＣＣＲ マスクビット
;-----------------------------------------------------------------------------
I_BIT_ON		.EQU	H'000000F0	; 割込禁止 RISC
I_BIT_OFF		.EQU	H'0000030F	; 割込許可 RISC

;-----------------------------------------------------------------------------
; ワンショットタイマ値ＭＡＸ
;-----------------------------------------------------------------------------
ONESHOT_VALUE_MAX		.EQU	26

;-----------------------------------------------------------------------------
; タスク イニシャルプログラムNo.
;-----------------------------------------------------------------------------
INIT_TID		.EQU	0
TSK_INITIAL		.EQU	0
;TSK_INI_ADDR	.EQU	H'FFFFFC00		; 初期化用スタック H'FFFFFC00-H'FFFFF000 3072byte
TSK_INI_ADDR	.EQU	H'FFFFF830		; 内蔵ＲＡＭのモデムバッファの領域を初期化用スタックに使用する

;-----------------------------------------------------------------------------
; モニタ システム
;-----------------------------------------------------------------------------

FLAG_INIT_DATA			.EQU	H'00000000	; RISC

;TASK_STACK_START		.EQU	H'00809800

;LARGE_STACK_MAX			.EQU	16			; RISC
;SMALL_STACK_MAX			.EQU	32			; RISC
;TOTAL_STACK_MAX			.EQU	(SMALL_STACK_MAX+LARGE_STACK_MAX)
;LARGE_STACK				.EQU	512
;SMALL_STACK				.EQU	256
;STACK_PUSH_SIZE			.EQU	88			;	スタック退避 88byte使用
;TOP_LARGE_ADDR 			.EQU	(TASK_STACK_START-(SMALL_STACK*SMALL_STACK_MAX)-STACK_PUSH_SIZE)
;TOP_SMALL_ADDR 			.EQU	(TASK_STACK_START-STACK_PUSH_SIZE)
STACK_PC_POSITION		.EQU	80
;STK_RTNVL_PT			.EQU	76

;-----------------------------------------------------------------------------
; TIB
;
; struct tib_table_data {
;	unsigned char *start_addr;
;	unsigned char *end_addr;
;	unsigned char stack_size;
;	unsigned char priority;
;	unsigned short reserve;
; };
;
;    ｮ｢｢｢｢｢｢｢｢｢｢｢ｲ
;  0 ､                      ､
;    ､                      ､
;  1 ､   タスクプログラム   ､
;    ､   スタートアドレス   ､
;  2 ､                      ､
;    ､                      ､
;  3 ､                      ､
;    ｾ｢｢｢｢｢｢｢｢｢｢｢ﾆ
;  4 ､                      ､
;    ､                      ､
;  5 ､   異常処理ルーチン   ､
;    ､   スタートアドレス   ､
;  6 ､                      ､
;    ､                      ､
;  7 ､                      ､
;    ｾ｢｢｢｢｢｢｢｢｢｢｢ﾆ
;  8 ､    スタックサイズ    ､  0:Large Stack  1:Small Stack
;    ｾ｢｢｢｢｢｢｢｢｢｢｢ﾆ
;  9 ､       優先順位       ､
;    ｾ｢｢｢｢｢｢｢｢｢｢｢ﾆ
; 10 ､       リザーブ       ､
;    ､                      ､
; 11 ､                      ､
;    ｶ｢｢｢｢｢｢｢｢｢｢｢ｺ
;
;      優先順位(0～255)
;      ※ 0を最も高い優先順位とします
;-----------------------------------------------------------------------------

TIB_TBL_SIZE	.EQU	12

;-- オフセット --
TIB_START_ADR		.EQU	0
TIB_END_ADR			.EQU	4
TIB_STACK_SIZE		.EQU	8
TIB_PRIORITY		.EQU	9

;-----------------------------------------------------------------------------
; TCB
;
; struct tcb_table_data {
;	unsigned char tsk_stat;
;	unsigned char prog_no;
;	unsigned char priority;
;	unsigned char tsk_link;
;	unsigned char run_link;
;	unsigned char tsk_stat_tpo;
;	unsigned short reserve;		RISC追加 by T.Nose
;	unsigned long wait_param;
;	unsigned char *stack_addr;
; };
;
;    ｮ｢｢ﾎ｢｢｢｢｢｢｢｢ｲ
;  0 ､STS ､ WAIT時の原因   ､   STS           WAIT時の原因
;    ｾ｢｢ﾖ｢｢｢｢｢｢｢｢ﾆ   11 : 未使用    1 : 送信待ち
;  1 ､     プログラムNo.    ､   00 : WAIT      2 : 受信待ち
;    ｾ｢｢｢｢｢｢｢｢｢｢｢ﾆ   01 : READY     3 : セマフォ待ち
;  2 ､       優先順位       ､                  4 : タイマ待ち
;    ｾ｢｢｢｢｢｢｢｢｢｢｢ﾆ                  5 : イベントフラグ待ち
;  3 ､     タスクリンク     ､                  6 : ワンショットタイマ待ち
;    ｾ｢｢｢｢｢｢｢｢｢｢｢ﾆ
;  4 ､    強制ランタスク    ､
;    ｾ｢｢｢｢｢｢｢｢｢｢｢ﾆ
;  5 ､待ちタスクパラメータ a､
;    ｾ｢｢｢｢｢｢｢｢｢｢｢ﾆ
;  6 ､       リザーブ       ､  アドレス調整用 RISC追加 by T.Nose
;    ､                      ､
;  7 ､                      ､
;    ｾ｢｢｢｢｢｢｢｢｢｢｢ﾆ
;  8 ､                     b､  1.送信待ち
;    ､                      ､     a     : MBX No
;  9 ､                     c､     b～e  : 送信データアドレス
;    ､                      ､  2.受信待ち
; 10 ､                     d､     a     : MBX No
;    ､                      ､     b～e  : 受信データアドレス
; 11 ､                     e､  3.セマフォ待ち
;    ｾ｢｢｢｢｢｢｢｢｢｢｢ﾆ     a,d,e : 未使用
; 12 ､                      ､     b,c   : セマフォ No
;    ､                      ､  4.タイマ待ち
; 13 ､                      ､     a,d,e : 未使用
;    ､   スタックアドレス   ､     b,c   : タイマ値
; 14 ､                      ､  5.イベントフラグ待ち
;    ､                      ､     a     : EVENT No
; 15 ､                      ､     b～e  : 未使用
;    ｶ｢｢｢｢｢｢｢｢｢｢｢ｺ  6.ワンショットタイマ待ち
;                                   a～e  : 未使用




;      スタックアドレス  初期値 = (実際のアドレス - 32byte)
;
;-----------------------------------------------------------------------------

;-- オフセット --
TCB_STAT			.EQU	0
TCB_PROGNO			.EQU	1
TCB_PRIORITY		.EQU	2
TCB_LINK			.EQU	3
TCB_RUN_LINK		.EQU	4
TCB_WAIT_PARAM		.EQU	5
TCB_RESERVE			.EQU	6
TCB_WAIT_PARA1		.EQU	8
TCB_WAIT_PARA2		.EQU	10
TCB_STACK_ADR		.EQU	12

;READY_TSK_MAX	.EQU	SMALL_STACK_MAX+LARGE_STACK_MAX
TCB_TBL_SIZE	.EQU	16

NIL				.EQU	H'ff
WORDNIL			.EQU	H'ffff
LONGNIL			.EQU	H'ffffffff

WAIT			.EQU	H'00	;RISC
READY			.EQU	H'40	;RISC
NOT_USED		.EQU	H'C0	;RISC

SND_WAIT		.EQU	H'01
RCV_WAIT		.EQU	H'02
WAIT_SEM		.EQU	H'03
WAIT_TIMER		.EQU	H'04
WAIT_EVENT		.EQU	H'05
WAIT_ONESHOT	.EQU	H'06

ERROR			.EQU	H'ff

;-----------------------------------------------------------------------------
; SCB
;
; struct scb_table_data {
;	unsigned char stat;
;	unsigned char tid;
; };
;
;    ｮ｢｢ﾎ｢｢｢｢｢｢｢｢ｲ
;  0 ､STS ､待ちタスクのTID ､
;    ｾ｢｢ﾖ｢｢｢｢｢｢｢｢ﾆ
;  1 ､   セマフォ獲得TID    ､
;    ｶ｢｢｢｢｢｢｢｢｢｢｢ｺ
;
;     STS
;          11 : 未使用
;          00 : セマフォ値=0
;          01 : セマフォ値=1
;
;     待ちタスクのTID
;          111111 : 待ちタスクなし
;
;-----------------------------------------------------------------------------

;SEMNO_MAX		.EQU	32
SCB_TBL_SIZE	.EQU	2
SCB_INIT		.EQU	H'7F
;SCB_FREE		.EQU	H'3F

;MAX_SEMNO		.EQU	15	; \src\atlanta\sh7043\define\def_semn.hに
							; 同一の定義有り。同値に保って下さい T.Nose 1996/01/09

;-- オフセット --
SCB_STAT		.EQU	0
SCB_TID			.EQU	1

;-----------------------------------------------------------------------------
; MCB
;
;    ｮ｢｢ﾎ｢｢｢｢｢｢ｲ
;    ､STS ､    TID     ､
;    ｶ｢｢ﾖ｢｢｢｢｢｢ｺ
;
;     STS                      TID
;     11 : 未使用              111111
;     10 : 待ちタスクなし      111111
;     00 : 送信待ちタスクあり  xxxxxx  待ちタスクの中で最も優先順位の高いTID
;     01 : 受信待ちタスクあり  xxxxxx  待ちタスクの中で最も優先順位の高いTID
;
;-----------------------------------------------------------------------------

;MBXNO_MAX		.EQU	256

;Task MAX Change T.Nose 1996/10/31
NO_WAIMBX		.EQU	H'7F	;<- H'BF
;SND_MBX			.EQU	H'00
;RCV_MBX			.EQU	H'40

;MAX_MBXNO		.EQU	70	; \src\atlanta\sh7043\define\def_mbxn.h に
							; 同一の定義有り。同値に保って下さい T.Nose 1996/01/09

;-----------------------------------------------------------------------------
; ECB
;
;    ｮ｢｢｢｢｢｢｢｢｢ｲ
;    ､       TID        ､
;    ｶ｢｢｢｢｢｢｢｢｢ｺ
;
;     TID
;     11111111 : 待ちタスクなし
;     xxxxxxxx : 待ちタスクのTID
;
;-----------------------------------------------------------------------------

;;EVENT_MAX		.EQU	74
;EVENT_MAX		.EQU	94     ; Changed with def_evtn.h for R288F event by H.Kubo 1997/06/30

;-----------------------------------------------------------------------------
; Ｃソースモニター用
;-----------------------------------------------------------------------------
MON_SUCCESS		.EQU	1	;モニター本体処理の戻値（結果）
MON_FAILURE		.EQU	0

